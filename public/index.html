<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, shrink-to-fit=no"
    />

    <title>Zenith Proxy</title>

    <!-- CSS -->
    <link rel="stylesheet" href="index.css" />

    <!-- ===== LOADING SCREEN STYLES ===== -->
    <style>
      #direct-loading {
        position: fixed;
        inset: 0;
        background: #0d0d0d;
        color: white;
        display: none;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        z-index: 100000;
        font-family:
          system-ui,
          -apple-system,
          BlinkMacSystemFont,
          sans-serif;
      }

      #direct-loading.show {
        display: flex;
      }

      .loader {
        width: 56px;
        height: 56px;
        border: 4px solid rgba(255, 255, 255, 0.15);
        border-top-color: white;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
        margin-bottom: 20px;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .fade-out {
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.4s ease;
      }
    </style>

    <!-- ===== DETECT ? AND ENABLE LOADER EARLY ===== -->
    <script>
      (function () {
        if (window.location.search && window.location.search !== "?") {
          document.documentElement.classList.add("direct-mode");
        }
      })();
    </script>

    <!-- Scramjet + deps -->
    <script src="/scram/scramjet.all.js"></script>
    <script src="baremux/index.js" defer></script>
    <script src="epoxy/index.js" defer></script>
    <script src="register-sw.js" defer></script>
    <script src="search.js" defer></script>
    <script src="index.js" defer></script>
  </head>

  <body>
    <!-- ===== DIRECT MODE LOADING SCREEN ===== -->
    <div id="direct-loading">
      <div class="loader"></div>
      <div style="opacity: 0.8; font-size: 1.1rem">Loading…</div>
    </div>

    <!-- TABS BAR -->
    <div id="tabsbar">
      <button id="newTabBtn" title="New Tab">＋ New Tab</button>
      <div id="tabsContainer" role="tablist"></div>
    </div>

    <!-- TOP URL BAR -->
    <div id="topbar">
      <form id="nav-form" autocomplete="off">
        <div id="nav-controls">
          <button id="backBtn" type="button" title="Back" disabled>◀</button>
          <button id="forwardBtn" type="button" title="Forward" disabled>
            ▶
          </button>
          <button id="refreshBtn" type="button" title="Refresh">⟳</button>
        </div>
        <input id="nav-input" type="text" placeholder="Enter URL or search" />
        <button id="goBtn" type="submit">Go</button>
      </form>
    </div>

    <!-- HOME -->
    <div id="home">
      <div
        class="flex-center"
        style="margin: 0; font-size: 3rem; font-weight: bold"
      >
        Zenith Proxy
      </div>

      <p style="opacity: 0.7; margin-top: 10px">
        A tab should automatically launch soon
      </p>
    </div>

    <!-- Errors -->
    <div class="desc left-margin">
      <p id="sj-error"></p>
      <pre id="sj-error-code"></pre>
    </div>

    <!-- ===== LOADER LOGIC ===== -->
    <script>
      if (window.location.search && window.location.search !== "?") {
        const loader = document.getElementById("direct-loading");
        loader.classList.add("show");

        window.addEventListener("load", () => {
          setTimeout(() => {
            loader.classList.add("fade-out");
          }, 300);
        });
      }
    </script>
  </body>
</html>
